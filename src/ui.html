<!-- https://github.com/thomas-lowry/figma-plugin-ds -->
<!DOCTYPE html>
    <head>
        <meta charset="utf-8">
        <title>Figma Plugin DS</title>
        <link rel="stylesheet" href="../node_modules/figma-plugin-ds/dist/figma-plugin-ds.css">
    </head>

    <body class="m-medium" style="border: solid 5px #00a096">

        <!-- <div class="onboarding-tip">
            <div class="icon icon--styles"></div>
            <div class="onboarding-tip__msg">Onboarding tip goes here.</div>
        </div> -->

        <div class="input">
            API Key: <input type="input" id="key" class="input__field" placeholder="Applitools API Key" style="width: 100%">
        </div>
        
        <div class="input">
            Server URL: <input type="input" id="url" class="input__field" placeholder="Applitools Server URL" value="https://eyesapi.applitools.com" style="width: 100%">
        </div>

        <div class="input">
            Proxy URL: <input type="input" id="proxy" class="input__field" placeholder="Your Proxy URL" style="width: 100%">
        </div>

        <p>
        <div class="switch">
            <input class="switch__toggle" type="checkbox" id="everything">
            <label class="switch__label" for="everything">Upload All Components</label>
        </div>
        </p>

        <p>
            <button id="save" class='button button--primary'>Send</button> 
            <button id="cancel" class='button--primary-destructive'>Cancel</button> 
        </p>

        <textarea rows=15 class="textarea" id="console" style="border: solid 2px rgb(0, 0, 0); width: 100%; max-width: 100%; resize: none; overflow-y: scroll;" disabled>Console</textarea>

        <script>
            (function() {
                var cors_api_host = 'infinite-dawn-90208.herokuapp.com';
                var cors_api_url = 'https://' + cors_api_host + '/';
                var slice = [].slice;
                var origin = window.location.protocol + '//' + window.location.host;
                var open = XMLHttpRequest.prototype.open;
                XMLHttpRequest.prototype.open = function() {
                    var args = slice.call(arguments);
                    var targetOrigin = /^https?:\/\/([^\/]+)/i.exec(args[1]);
                    if (targetOrigin && targetOrigin[0].toLowerCase() !== origin &&
                        targetOrigin[1] !== cors_api_host) {
                        args[1] = cors_api_url + args[1];
                    }
                    return open.apply(this, args);
                };
            })();

            (function () {
                if (!console) {
                    console = {};
                }
                var old = console.log;
                var logger = document.getElementById('console');
                console.log = function (message) {
                    if (typeof message == 'object') {
                        logger.innerHTML += (JSON && JSON.stringify ? JSON.stringify(message) : String(message) + '\n');
                    } else {
                        logger.innerHTML += message + '\n';
                    }
                }
            })();

            var textarea = document.getElementById('console');
            textarea.scrollTop = textarea.scrollHeight;
        </script>
    </body>
</html>